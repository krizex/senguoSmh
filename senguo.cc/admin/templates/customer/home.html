{% extends 'base.html' %}
{% block title %}首页{% end %}
{% block head %}
<link rel="stylesheet" href="{{static_url('css/market-home.css')}}"/>
{% end %}
{% block content %}
{% set fruits=context['fruits']%}
{% set dry_fruits=context['dry_fruits']%}
{% set mgoods=context['mgoods']%}
{% set menus=context['menus']%}
{% set cart_f=context['cart_f'] %}
{% set cart_m=context['cart_m'] %}
{% set notices=context['notices'] %}
<div class="notice-board">
    <div id="slider" class="swipe" style="visibility: visible;">
        <div class="swipe-wrap">
            {% for notice in notices%}
            <figure>
                <div class="wrap text-center text-white font16">
                    <label class="title">{{notice.summary}}</label>
                    <!--<p class="detail">{{notice.detail}}</p>-->
                    <img src="{{static_url('images/banner.jpg')}}"/>
                </div>
            </figure>
            {% end %}
        </div>
    </div>
    <nav class="circle">
        <ul id="position">
            {% for notice in notices%}
            <li></li>
            {% end %}
        </ul>
    </nav>
</div>

<p class="text-white no-mar-btom classify-title font16" id="fruitPosition">水果单品</p>
<ul class="goods-list bg-white fruit-list">
    {% for fruit in fruits %}
    {% set farrow_active=''%}
    {% set ftoggle_active=''%}
    {%if len(fruit.charge_types) >1 %}
        {% set farrow_active='arrow'%}
        {% set ftoggle_active='toggle'%}
    {% end %}
    <li class="goods-list-item bg-pale-green font14 text-grey {{farrow_active}}" data-id="{{fruit.id}}" data-type="fruit" data-num="{{fruit.storage}}">
        <div class="goods-img col-lg-2 col-md-2 col-xs-3 col-sm-2 p0">
            <a href="javascript:;" class="check-lg-img">
                <span class="tag bg-green text-white text-center tagItem font8" data-id="{{fruit.tag}}">hot</span>
                {% if fruit.img_url %}
                <img src="{{fruit.img_url}}?imageView/1/w/200/h/200" class="img">
                {% else %}
                <img src="/static/design_img/{{fruit.fruit_type.code}}.png" class="img">
                {% end %}
            </a>
        </div>
        <input type="hidden" class="fruit_intro" value="{{fruit.intro}}"/>
        <div class="col-lg-10 col-md-10 col-xs-9 col-sm-10 pull-right p0">
            <div class="show-box {{ftoggle_active}}">
                <p>
                    <span class="pull-left color fruit-name font12">{{fruit.name}}</span>
                    <span class="pull-right text-grey sale">{{fruit.saled}}</span>
                </p>
                <p class="great-number">
                    <span class="great">{{fruit.favour}}</span>
                </p>
                <div class="charge-first charge-style  font12">
                    {% if fruit.charge_types %}
                    <span class="col-sm-6 col-xs-6 text-bgcolor p0 charge-type line34 height34" data-id="{{fruit.charge_types[0].id}}">
                        {{fruit.charge_types[0].price}}元/{{fruit.charge_types[0].num}}
                        <span data-id="{{fruit.charge_types[0].unit}}" class="chargeUnit"></span>
                    </span>
                    {% end %}
                    {% set value = cart_f[fruit.charge_types[0].id]["num"] if fruit.charge_types[0].id in cart_f else 0%}
                 <span class="to-add line34 height34 text-center font16 text-grey2 bg-white pull-right">+</span>
                 <span class="pull-right p0 number-change" style="display:none">
                    <a class="minus-plus text-green bg-white pull-right number-plus line34 height34 text-center font16" href="javascript:;">+</a>
                    <input type="text" value="{{value}}" class="number-input pull-right text-green text-center line34 height34" readonly/>
                    <a class="minus-plus text-green bg-white pull-right number-minus line34 height34 text-center font16" href="javascript:;">-</a>
                </span>
                </div>
            </div>
            <ul class="charge-list charge-style color set-width-float font12" style="display:none">
                {% for charge in fruit.charge_types %}
                {% if charge.id !=fruit.charge_types[0].id %}
                    {% set value = cart_f[charge.id]["num"] if charge.id in cart_f else 0%}
                <li class="border-color set-w100-fle">
                    <span class="col-sm-5  col-xs-5 text-bgcolor p0 charge-type" data-id="{{charge.id}}">
                        {{charge.price}}元/{{charge.num}}
                        <span data-id="{{charge.unit}}" class="chargeUnit"></span>
                    </span>
                    <span class="to-add line34 height34 text-center font16 text-grey2 bg-white pull-right">+</span>
                    <span class="pull-right p0 number-change" style="display:none">
                        <a class="minus-plus text-green bg-white pull-right number-plus line34 height34 text-center font16" href="javascript:;">+</a>
                        <input type="text" value="{{value}}" class="number-input pull-right text-green text-center line34 height34" readonly/>
                        <a class="minus-plus text-green bg-white pull-right number-minus line34 height34 text-center font16" href="javascript:;">-</a>
                    </span>
                </li>
                {% end %}
                {% end %}
            </ul>
        </div>
    </li>
    {% end %}
</ul>
{% if dry_fruits%}
    <p class="text-white no-mar-btom classify-title font16" id="dryFruitPosition">干果单品</p>
    <ul class="goods-list bg-white fruit-list">
        {% for dry_fruit in dry_fruits %}
        {% set darrow_active=''%}
        {% set dtoggle_active=''%}
        {%if len(dry_fruit.charge_types) >1 %}
            {% set darrow_active='arrow'%}
            {% set dtoggle_active='toggle'%}
        {% end %}
        <li class="goods-list-item bg-pale-green font14 text-grey {{darrow_active}}" data-id="{{dry_fruit.id}}" data-type="fruit" data-num="{{dry_fruit.storage}}">
            <div class="goods-img col-lg-2 col-md-2 col-xs-3 col-sm-2 p0">
                <a href="javascript:;" class="check-lg-img">
                    <span class="tag bg-green text-white text-center tagItem font8" data-id="{{dry_fruit.tag}}">hot</span>
                    {% if fruit.img_url %}
                    <img src="{{dry_fruit.img_url}}?imageView/1/w/200/h/200" class="img">
                    {% else %}
                    <img src="/static/design_img/{{dry_fruit.fruit_type.code}}.png" class="img">
                    {% end %}
                </a>
            </div>
            <input type="hidden" class="fruit_intro" value="{{dry_fruit.intro}}"/>
            <div class="col-lg-10 col-md-10 col-xs-9 col-sm-10 pull-right p0">
                <div class="show-box {{dtoggle_active}}">
                    <p>
                        <span class="pull-left color fruit-name font12">{{dry_fruit.name}}</span>
                        <span class="pull-right text-grey sale">{{dry_fruit.saled}}</span>
                    </p>
                    <p class="great-number">
                        <span  class="great">{{dry_fruit.favour}}</span>
                    </p>
                    <div class="charge-first charge-style  font12">
                        {% if dry_fruit.charge_types %}
                        <span class="col-sm-6 col-xs-6 text-bgcolor p0 charge-type line34 height34" data-id="{{dry_fruit.charge_types[0].id}}">
                            {{dry_fruit.charge_types[0].price}}元/{{dry_fruit.charge_types[0].num}}
                            <span data-id="{{fruit.charge_types[0].unit}}" class="chargeUnit"></span>
                        </span>
                        {% end %}
                        {% set value = cart_f[dry_fruit.charge_types[0].id]["num"] if dry_fruit.charge_types[0].id in cart_f else 0%}
                        <span class="to-add line34 height34 text-center font16 text-grey2 bg-white pull-right">+</span>
                        <span class="pull-right p0 number-change" style="display:none">
                            <a class="minus-plus text-green bg-white pull-right number-plus line34 height34 text-center font16" href="javascript:;">+</a>
                            <input type="text" value="{{value}}" class="number-input pull-right text-green text-center line34 height34" readonly/>
                            <a class="minus-plus text-green bg-white pull-right number-minus line34 height34 text-center font16" href="javascript:;">-</a>
                        </span>
                    </div>
                </div>
                <ul class="charge-list charge-style color set-width-float font12" style="display:none">
                    {% for charge in dry_fruit.charge_types %}
                    {% if charge.id !=dry_fruit.charge_types[0].id %}
                    {% set value = cart_f[charge.id]["num"] if charge.id in cart_f else 0%}
                    <li class="border-color set-w100-fle">
                        <span class="col-sm-5  col-xs-5 text-bgcolor p0 charge-type" data-id="{{charge.id}}">
                            {{charge.price}}元/{{charge.num}}
                            <span data-id="{{charge.unit}}" class="chargeUnit"></span>
                        </span>
                        <span class="to-add line34 height34 text-center font16 text-grey2 bg-white pull-right">+</span>
                        <span class="pull-right p0 number-change" style="display:none">
                            <a class="minus-plus text-green bg-white pull-right number-plus line34 height34 text-center font16" href="javascript:;">+</a>
                            <input type="text" value="{{value}}" class="number-input pull-right text-green text-center line34 height34" readonly/>
                            <a class="minus-plus text-green bg-white pull-right number-minus line34 height34 text-center font16" href="javascript:;">-</a>
                        </span>
                    </li>
                    {% end %}
                    {% end %}
                </ul>
            </div>
        </li>
        {% end %}
    </ul>
{% end %}
{% for menu in menus %}
    {% if mgoods[menu.id] %}
    <p class="text-white no-mar-btom classify-title  font16" id="menu{{menu.id}}">{{menu.name}}</p>
    <ul class="goods-list bg-white menu-list">
    {% end %}
    {% for mgood in mgoods[menu.id]%}
        {% set marrow_active=''%}
        {% set mtoggle_active=''%}
        {%if len(mgood.mcharge_types) >1 %}
            {% set marrow_active='arrow'%}
            {% set mtoggle_active='toggle'%}
        {% end %}
        <li class="goods-list-item  bg-pale-green font14 text-grey {{marrow_active}}" data-id="{{mgood.id}}" data-type="menu" data-num="{{mgood.storage}}">
            <div class="goods-img col-lg-2 col-md-2 col-xs-3 col-sm-2 p0">
                <a href="javascript:;" class="check-lg-img">
                    <span class="tag bg-green text-white text-center tagItem font8" data-id="{{mgood.tag}}">hot</span>
                    {% if mgood.img_url %}
                    <img src="{{mgood.img_url}}?imageView/1/w/200/h/200" class="img">
                    {% else %}
                    <img src="/static/design_img/TDSG.png" class="img">
                    {% end %}
                </a>
            </div>
            <input type="hidden" class="fruit_intro" value="{{mgood.intro}}"/>
            <div class="col-lg-10 col-md-10 col-xs-9 col-sm-10 pull-right p0">
                <div class="show-box {{mtoggle_active}}">
                    <p>
                        <span class="pull-left color fruit-name font12">{{mgood.name}}</span>
                        <span class="pull-right text-grey sale">{{mgood.saled}}</span>
                    </p>
                    <p class="great-number">
                        <span  class="great">{{mgood.favour}}</span>
                    </p>
                    <div class="charge-first charge-style  font12">
                        {% if mgood.mcharge_types %}
                        <span class="col-sm-6 col-xs-6 text-bgcolor p0 charge-type line34 height34" data-id="{{mgood.mcharge_types[0].id}}">
                            {{mgood.mcharge_types[0].price}}元/{{mgood.mcharge_types[0].num}}
                            <span data-id="{{mgood.mcharge_types[0].unit}}" class="chargeUnit"></span>
                        </span>
                        {% end %}
                        {% set value = cart_m[mgood.mcharge_types[0].id]["num"] if mgood.mcharge_types[0].id in cart_m else 0%}
                        <span class="to-add line34 height34 text-center font16 text-grey2 bg-white pull-right">+</span>
                         <span class="pull-right p0 number-change" style="display:none">
                            <a class="minus-plus text-green bg-white pull-right number-plus line34 height34 text-center font16" href="javascript:;">+</a>
                            <input type="text" value="{{value}}" class="number-input pull-right text-green text-center line34 height34" readonly/>
                            <a class="minus-plus text-green bg-white pull-right number-minus line34 height34 text-center font16" href="javascript:;">-</a>
                        </span>
                    </div>
                </div>
                <ul class="charge-list charge-style color set-width-float font12" style="display:none">
                    {% for charge in mgood.mcharge_types %}
                    {% if charge.id !=mgood.mcharge_types[0].id %}
                    {% set value = cart_m[charge.id]["num"] if charge.id in cart_m else 0%}
                    <li class="border-color set-w100-fle">
                        <span class="col-sm-5  col-xs-5 text-bgcolor p0 charge-type" data-id="{{charge.id}}">
                            {{charge.price}}元/{{charge.num}}
                            <span data-id="{{charge.unit}}" class="chargeUnit"></span>
                        </span>
                        <span class="to-add line34 height34 text-center font16 text-grey2 bg-white pull-right">+</span>
                        <span class="pull-right p0 number-change" style="display:none">
                            <a class="minus-plus text-green bg-white pull-right number-plus line34 height34 text-center font16" href="javascript:;">+</a>
                            <input type="text" value="{{value}}" class="number-input pull-right text-green text-center line34 height34" readonly/>
                            <a class="minus-plus text-green bg-white pull-right number-minus line34 height34 text-center font16" href="javascript:;">-</a>
                        </span>
                    </li>
                    {% end %}
                    {% end %}
                </ul>
            </div>
        </li>
        {% end %}
    </ul>
{% end %}
<div class="modal fade large-img-box"  tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close text-green2 font18" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title text-green2 text-center" id="myModalLabel">是水果啊啊啊</h4>
            </div>
            <div class="modal-body set-width-float text-center">
                <img src="" id="largeImg"/>
                <p class="intro font14">哈哈哈哈哈哈</p>
            </div>
            <div class="modal-footer">
                <a href="javascript:;" class="click-great text-center font18 text-grey3">赞一个</a>
            </div>
        </div>
    </div>
</div>
{% end %}
{% block toTop %}
<ul class="right-nav">
    <li class="set-inl-blo bg-grey3 text-green text-center font14" data-toggle="modal" data-target="#goods-classify">分类</li>
    <li class="set-inl-blo bg-grey3 text-green text-center font14" id="backTop">置顶</li>
</ul>
<div class="modal fade classify"  tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" id="goods-classify">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header"></div>
            <div class="modal-body set-width-float text-center">
                <ul class="font16 goods-class-choose type-choose list-group">
                    {% if fruits%}
                    <li class="text-green list-group-item" data-dismiss="modal" data-class="fruitPosition">水果</li>
                    {% end %}
                    {% if dry_fruits%}
                    <li class="text-green list-group-item" data-dismiss="modal" data-class="dryFruitPosition">干果</li>
                    {% end %}
                    {% for menu in menus %}
                        {% if mgoods[menu.id] %}
                        <li class="text-green list-group-item" data-dismiss="modal" data-class="menu{{menu.id}}">{{menu.name}}</li>
                        {% end %}
                    {% end %}
                </ul>
            </div>
        </div>
    </div>
</div>
{% end %}
{% block bottom %}
<script src="{{static_url('js/swipe.js')}}"></script>
<script src="{{static_url('js/market-home.js')}}"></script>
{% end %}
