{% extends 'market-set-base.html' %}
{% block title%}公告设置{% end %}

{% block setcontent %}
<input type="hidden" id="data" value="{{token}}"/>
<div class="set-description">
    <p>编辑和修改商城水果公告栏的内容</p>
    <p>摘要为公告栏直接显示的内容，用户可点击查看详情。</p>
</div>
<ul class="notice-type-choose subnav">
    <li class="active">普通公告</li>
    <li>活动公告</li>
</ul>
<table class="set-list table table-bordered ">
    <tr class="bg-grey2">
        <td>状态</td>
        <td>摘要</td>
        <td>链接/详情</td>
        <td>背景</td>
        <td>操作</td>
    </tr>
    {% for notice in notices  %}
    {% if notice._type == 0 %}
    <tr class="set-list-item" data-id="{{notice.id}}">
        <td>
            <div class="mode action-mode notice_active" data-status="{{notice.active}}">
                <a class="work-mode" href="javascript:;" style="display:none;">已启用</a>
                <a class="stop-mode" href="javascript:;" style="display:none;">未启用</a>
            </div>
        </td>
        <td class="col-lg-3 address-show summary">{% if notice.summary %}{{notice.summary.strip() or '无'}}{% end %}</td>
        <td class="col-lg-3 address-edit" style="display:none;">
            <textarea class="notice_summary">{{notice.summary}}</textarea>
        </td>
        <td class="col-lg-4 address-show">
            <p>链接: <span class="link"><a class="con" href="{{notice.link or ''}}" target="_blank">{% if notice.link %}{{notice.link.strip() or ''}}{% end %}</a>{%if notice.click_type==1 %} √{% end %}</span></p>
            <p>详情: <span class="detail"><span class="con">{% if notice.detail %}{{notice.detail.strip() or '无'}}{% else %}无{% end %}</span>{%if notice.click_type==0 %} √{% end %}</span></p>
        </td>
        <td class="col-lg-4 address-edit" style="display:none;">
            <div class="href_type {%if notice.click_type==1 %}active{% end %}" data-id="1"><span class="pull-left">链接:</span><input class="notice_link ml10" value="{{notice.link}}"></div>
            <div class="href_type mt10 {%if notice.click_type==0 %}active{% end %}" data-id="0"><span class="pull-left">详情:</span><textarea class="notice_detail ml10">{{notice.detail}}</textarea></div>
        </td>
        <td class="col-lg-3 address-show img_url">
            <div class="notice_img_box">
                <img src="{{notice.img_url or '/static/images/holder_fruit.jpg'}}?imageView2/1/w/180/h/100" class="notice_img"/>
            </div>
        </td>
        <td class="col-lg-3 address-edit"  style="display:none;">
            <div class="notice_img_box" id="wrap-legal-img">
                <img class="notice_img preview-img" src="{{notice.img_url or '/static/images/holder_fruit.jpg'}}?imageView2/1/w/180/h/100" alt="背景" url="{{notice.img_url}}"/>
                <span class="title text-white text-center edit-img">点击修改</span>
            </div>
        </td>
        <td class="address-show">
            <a href="javascript:;" class="edit-btn2 notice-edit">编辑</a>
        </td>
        <td class="address-edit" style="display:none;">
            <a href="javascript:;" class="edit-btn2 info-sure notice_edit bg-green text-white text-center">确定</a>
        </td>
    </tr>
    {% end %}
    {% end %}
</table>
<table class="set-list table table-bordered" style="display:none">
    <tr class="bg-grey2">
        <td class="text-center">活动状态<p>（通告状态与相对应的营销活动同步）</p></td>
        <td class="text-center">活动内容</td>
        <td class="text-center">摘要</td>
        <td class="text-center">链接<p>（点击商城背景可至活动专场）</p></td>
        <td class="text-center">背景</td>
        <td class="text-center">操作</td>
    </tr>
    {% for notice in notices  %}
    {% if notice._type > 0 %}
    <tr class="set-list-item" data-id="{{notice.id}}">
        <td class="col-lg-2">
            <div class="mode action-mode notice_active" data-status="{{notice.active}}">
                <a class="work-mode" href="javascript:;" style="display:none;">已启用</a>
                <a class="stop-mode" href="javascript:;" style="display:none;">未启用</a>
            </div>
        </td>
        <td class="col-lg-1">{% if notice._type==1 %}秒杀{% elif notice._type == 2 %}限时折扣{% elif notice_type == 3%}优惠券{% end %}</td>
        <td class="col-lg-2 address-show summary">{% if notice.summary %}{{notice.summary.strip() or '无'}}{% end %}</td>
        <td class="col-lg-2 address-edit" style="display:none;">
            <textarea class="notice_summary">{{notice.summary or ''}}</textarea>
        </td>
        <td class="col-lg-3 address-show">
            <span class="link"><a class="con" href="{{notice.link or ''}}" target="_blank">{% if notice.link %}{{notice.link.strip() or ''}}{% end %}</a></
        </td>
        <td class="col-lg-3 address-edit" style="display:none;">
            <input class="notice_link ml10" value="{{notice.summary or ''}}">
        </td>
        <td class="col-lg-3 address-show img_url">
            <div class="notice_img_box">
                <img src="{{notice.img_url or '/static/images/holder_fruit.jpg'}}?imageView2/1/w/180/h/100" class="notice_img"/>
            </div>
        </td>
        <td class="col-lg-3 address-edit"  style="display:none;">
            <div class="notice_img_box" id="wrap-legal-img">
                <img class="notice_img preview-img" src="{{notice.img_url or '/static/images/holder_fruit.jpg'}}?imageView2/1/w/180/h/100" alt="背景" url="{{notice.img_url}}"/>
                <span class="title text-white text-center edit-img">点击修改</span>
            </div>
        </td>
        <td class="address-show">
            <a href="javascript:;" class="edit-btn2 notice-edit">编辑</a>
        </td>
        <td class="address-edit" style="display:none;">
            <a href="javascript:;" class="edit-btn2 info-sure notice_edit bg-green text-white text-center">确定</a>
        </td>
    </tr>
    {% end %}
    {% end %}
</table>
    <a href="javascript:;" class="add-new-address1  add-btn-sty">+ 新建公告消息</a>
    <div class="modal fade text-grey3" id="noticeBox" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                    <h4 class="modal-title" id="myModalLabel">新建公告消息</h4>
                </div>
                <div class="modal-body">
                    <p class="clearfix set-top10">
                        <span class="pull-left set-left20 set-right20 font14">摘要</span>
                        <input type="text" class="new-notice-title pull-left"/>
                    </p>
                    <div class="clearfix">
                        <span class="pull-left set-left20 set-right20 font14">详情</span>
                        <textarea class="new-notice-detail pull-left" placeholder="请填写公告详情，公告详情只在“模版一”中展示"></textarea>
                    </div>
                     <div class="clearfix">
                        <span class="pull-left set-left20 set-right20 font14">链接</span>
                        <input type="text" class="new-notice-link pull-left"/>
                    </div>
                    <div class="clearfix mt10">
                        <span class="pull-left set-left20 set-right20 font14">点击公告背景跳转</span>
                        <ul class="link-type">
                            <li class="{%if notice and notice.click_type == 0 or not notice%}active{% end %} fl" data-id="0">详情</li>
                            <li class="{%if notice and notice.click_type == 1 %}active{% end %} fr" data-id="1">链接</li>
                        </ul>
                    </div>
                    <div class="clearfix mt10">
                        <span class="pull-left set-left20 set-right20 font14">背景</span>
                        <div class="img_add_box" id="wrap-add-img">
                            <span class="title text-white text-center button bg-green" id="upload-add">添加背景</span>
                            <img class="hide mt10" src="" alt="背景" id="add-img"/>
                        </div>
                    </div>
                </div>
                <div class="modal-footer text-center">
                    <button class="btn bg-green text-white add-new-notice">确定</button>
                    <button class="btn btn-default" data-dismiss="modal">取消</button>
                </div>
            </div>
        </div>
    </div>
{% end %}
{% block setbottom %}
<script src="/static/js/plupload/plupload.full.min.js"></script>
<script src="/static/js/plupload/i18n/zh_CN.js"></script>
<script src="/static/js/qiniu.min.js"></script>
<script src="{{static_url('js/admin-notice-set.js')}}"></script>
{% end %}