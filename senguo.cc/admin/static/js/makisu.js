(function(d){var c=false;var a=document.createElement("div");var l=/^(Moz|(w|W)ebkit|O|ms)(?=[A-Z])/;var k=(function(){for(var v in a.style){if(l.test(v)){return v.match(l)[0]}}})()||"";var f=k+"Perspective" in a.style;var o="-"+k.toLowerCase()+"-";var e,t,h,p,r,b,u,s;var j,n,g;var i={toggle:function(){e=d(this);e.makisu(e.hasClass("open")?"close":"open")},open:function(w,v,x){e=d(this);t=e.find(".root");p=e.find(".node").not(t);w=q.resolve(e,"speed",w);x=q.resolve(e,"easing",x);v=q.resolve(e,"overlap",v);p.each(function(y,z){n="unfold"+(!y?"-first":"");g=y===p.length-1;time=w*(1-v);j=y*time;b=d(z);u=b.find(".over");b.css(q.prefix({transform:"rotateX(180deg)",animation:n+" "+w+"s "+x+" "+j+"s 1 normal forwards"}));if(!g){j=(y+1)*time}u.css(q.prefix({animation:"unfold-over "+(w*0.45)+"s "+x+" "+j+"s 1 normal forwards"}))});t.css(q.prefix({animation:"swing-out "+(p.length*time*1.4)+"s ease-in-out 0s 1 normal forwards"}));e.addClass("open")},close:function(w,v,x){e=d(this);t=e.find(".root");p=e.find(".node").not(t);w=q.resolve(e,"speed",w)*0.66;x=q.resolve(e,"easing",x);v=q.resolve(e,"overlap",v);p.each(function(y,z){n="fold"+(!y?"-first":"");g=y===0;time=w*(1-v);j=(p.length-y-1)*time;b=d(z);u=b.find(".over");b.css(q.prefix({transform:"rotateX(0deg)",animation:n+" "+w+"s "+x+" "+j+"s 1 normal forwards"}));if(!g){j=((p.length-y-2)*time)+(w*0.35)}u.css(q.prefix({animation:"fold-over "+(w*0.45)+"s "+x+" "+j+"s 1 normal forwards"}))});t.css(q.prefix({animation:"swing-in "+(p.length*time*1)+"s ease-in-out 0s 1 normal forwards"}));e.removeClass("open")}};var q={resolve:function(w,v,x){return typeof x==="undefined"?w.data(v):x},prefix:function(w){for(var v in w){w[o+v]=w[v]}return w},inject:function(x){try{var w=document.createElement("style");w.innerHTML=x;document.getElementsByTagName("head")[0].appendChild(w)}catch(v){}}};var m={node:'<span class="node"/>',back:'<span class="face back"/>',over:'<span class="face over"/>'};d.fn.makisu=function(w){if(!f){var y="Failed to detect CSS 3D support";if(console&&console.warn){console.warn(y);this.each(function(){d(this).trigger("error",y)})}return}if(!c){c=true;q.inject("@"+o+"keyframes unfold        {0%   {"+o+"transform: rotateX(180deg);  }50%  {"+o+"transform: rotateX(-30deg);  }100% {"+o+"transform: rotateX(0deg);    }}");q.inject("@"+o+"keyframes unfold-first  {0%   {"+o+"transform: rotateX(-90deg);  }50%  {"+o+"transform: rotateX(60deg);   }100% {"+o+"transform: rotateX(0deg);    }}");q.inject("@"+o+"keyframes fold          {0%   {"+o+"transform: rotateX(0deg);    }100% {"+o+"transform: rotateX(180deg);  }}");q.inject("@"+o+"keyframes fold-first    {0%   {"+o+"transform: rotateX(0deg);    }100% {"+o+"transform: rotateX(-180deg); }}");q.inject("@"+o+"keyframes swing-out     {0%   {"+o+"transform: rotateX(0deg);    }30%  {"+o+"transform: rotateX(-30deg);  }60%  {"+o+"transform: rotateX(15deg);   }100% {"+o+"transform: rotateX(0deg);    }}");q.inject("@"+o+"keyframes swing-in      {0%   {"+o+"transform: rotateX(0deg);    }50%  {"+o+"transform: rotateX(-10deg);  }90%  {"+o+"transform: rotateX(15deg);   }100% {"+o+"transform: rotateX(0deg);    }}");q.inject("@"+o+"keyframes unfold-over   {0%   { opacity: 1.0; }100% { opacity: 0.0; }}");q.inject("@"+o+"keyframes fold-over     {0%   { opacity: 0.0; }100% { opacity: 1.0; }}");q.inject(".node {position: relative;display: block;}");q.inject(".face {pointer-events: none;position: absolute;display: block;height: 100%;width: 100%;left: 0;top: 0;}")}var x=d.extend({},d.fn.makisu.defaults,w);var v=Array.prototype.slice.call(arguments,1);return this.each(function(){if(i[w]){return i[w].apply(this,v)}e=d(this).data(x);if(!e.data("initialized")){e.data("initialized",true);p=e.children(x.selector);t=d(m.node).addClass("root");h=t;p.each(function(z,A){b=d(A);n="fold"+(!z?"-first":"");b.css("position","relative");b.css(q.prefix({"transform-style":"preserve-3d",transform:"translateZ(-0.1px)"}));s=d(m.back);s.css("background",b.css("background"));s.css(q.prefix({transform:"translateZ(-0.1px)"}));u=d(m.over);u.css(q.prefix({transform:"translateZ(0.1px)"}));u.css({background:x.shading,opacity:0});r=d(m.node).append(b);r.css(q.prefix({"transform-origin":"50% 0%","transform-style":"preserve-3d",animation:n+" 1ms linear 0s 1 normal forwards"}));b.append(u);b.append(s);h.append(r);h=r});t.css(q.prefix({"transform-origin":"50% 0%","transform-style":"preserve-3d"}));e.css(q.prefix({transform:"perspective("+x.perspective+"px)"}));e.append(t)}})};d.fn.makisu.defaults={perspective:1200,shading:"rgba(0,0,0,0.12)",selector:null,overlap:0.6,speed:0.8,easing:"ease-in-out"};d.fn.makisu.enabled=f})(jQuery);
